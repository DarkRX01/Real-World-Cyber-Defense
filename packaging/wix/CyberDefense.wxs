<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*"
           Name="Cyber Defense"
           Language="1033"
           Version="2.0.0"
           Manufacturer="Cyber Defense"
           UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="Cyber Defense" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="Cyber Defense">
          <Component Id="ProductComponents" Guid="B2C3D4E5-F6A7-8901-BCDE-F12345678901">
            <File Id="CyberDefenseExe"
                  Source="..\..\dist\CyberDefense\CyberDefense.exe"
                  KeyPath="yes" />
            <!-- Add other files from dist/CyberDefense if onedir -->
          </Component>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="Cyber Defense">
          <Component Id="ApplicationShortcut" Guid="C3D4E5F6-A7B8-9012-CDEF-123456789012">
            <Shortcut Id="DesktopShortcut"
                      Name="Cyber Defense"
                      Description="Real-World Cyber Defense"
                      Target="[INSTALLFOLDER]CyberDefense.exe"
                      WorkingDirectory="INSTALLFOLDER" />
            <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
            <RegistryValue Root="HKCU" Key="Software\Cyber Defense" Name="installed" Type="integer" Value="1" KeyPath="yes" />
          </Component>
        </Directory>
      </Directory>
    </Directory>
  </Product>
</Wix>
